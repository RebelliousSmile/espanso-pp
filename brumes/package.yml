matches:
  - trigger: ":mark"
    replace: "<mark class='spectrum'>$|$</mark>"  

  - trigger: ":clue"
    replace: ">[!clue] $|$"  
  
  - trigger: ":sclue"
    replace: ">[!special-clue] $|$"  

  - trigger: ":tag"
    replace: "<mark class='tag'>$|$</mark>"  

  - trigger: ":status"
    replace: "<mark class='status'>$|$</mark>"  

  - trigger: ":note"
    replace: ">[!move] $|$"  

  - trigger: ":desc"
    replace: ">[!description] $|$"  

  - trigger: ":danger"
    replace: |
      <div class='danger {{form.class}}'>
        <h3>{{form.title}} {{form.stars}}</h3>
        <p>{{form.description}}</p>
        <h4>{{form.subtitle}}</h4>
        <ul>
        $(python3 -c "
          import re
          import sys

          text = sys.stdin.read()
          items = re.findall(r'[^\n]+', text)

          for item in items:
            print(f'<li>{item}</li>')
          ")
        </ul>
        <hr>
        <ul>
        $(for list_item in ${form.list2}; do
          echo "<li>${list_item}</li>"
        done)
        </ul>
        <hr>
        <ul>
        $(for list_item in ${form.list3}; do
          echo "<li>${list_item}</li>"
        done)
        </ul>
      </div>
    vars:
      - name: "form"
        type: form
        params:
          layout: |
            Class: [[class]]
            Title: [[title]]
            Stars: [[stars]]
            Description: [[description]]
            Subtitle: [[subtitle]]
            List 1: [[list1]]
            List 2: [[list2]]
            List 3: [[list3]]
          fields:
            class:
              value: "bg3"
            title: {}
            stars:
              type: list
              values:
                - " "
                - "★"
                - "★★"
                - "★★★"
                - "★★★★"
                - "★★★★★"
            description:
              multiline: true
            subtitle: {}
            list1:
              type: script
              params:
                script: |
                  import re
                  import espanso

                  trigger_match = espanso.get_trigger_match()
                  text = trigger_match.group(0)
                  items = re.findall(r'[^\n]+', text)

                  form_data = {
                    'list1': '\n'.join(items),
                  }
                  espanso.set_variable('form', form_data)
            list2:
              multiline: true
            list3:
              multiline: true
